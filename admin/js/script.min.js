function loadProgress(){NbObjLoaded++,$("#loader-fill").stop().animate({width:NbObjLoaded/NbObjToLoad*100+"%"},500,function(){NbObjLoaded/NbObjToLoad===1&&$("#loader").fadeOut(600)})}function absToRel(a,b){for(var c=-1;;){if(~b.indexOf(a)){var d="";if(c)for(var e=0;c>e;e++)d+="../";else d="./";return b.replace(a,d)}a=a.split("/"),a.pop(),a=a.join("/"),c++}}var activeTuto=!1,stepTuto=1,activeResize=!1,oldIframeWidth=1920,oldIframeHeight=1080,dragoutTimeout=null,allImages=["background.png","backnode.png","logo.png","resize.png","switch.png"],imgAllowed=["image/png","image/jpeg","image/jpg","image/gif"],NbObjToLoad=4+allImages.length,NbObjLoaded=0;$(window.document).ready(function(){function a(a,b,c){var i=(f.width()-a)/2-g,j=(f.height()-b)/2-h;i=i>=10?i:10,j=j>=10?j:10,e.stop().animate({left:i,right:i,top:j,bottom:j},{duration:c?250:0,step:function(){$("#iframe-width").text(d.width()),$("#iframe-height").text(d.height()),d.height(e.height()-45)},complete:function(){$("#iframe-width").text(a),$("#iframe-height").text(b),d.height(e.height()-45)}})}for(var b=0;b<allImages.length;++b){var c=new window.Image;c.onload=loadProgress,c.src="img/"+allImages[b]}var d=$("#iframe"),e=$("#resize-iframe"),f=$("#iframe-container"),g=($("#resize-iframe").outerWidth()-$("#resize-iframe").width())/2,h=($("#resize-iframe").outerHeight()-$("#resize-iframe").height()+$("#resize-bar").height())/2;window.backNode=new BackNode(d[0]),$("#tools #editor").click(function(){$(this).toggleClass("switch-on"),backNode.editor.editable(backNode.baliseSearch.getList(backNode.document),$(this).hasClass("switch-on"))}),$("#tools #open").click(function(){backNode.explorer.pick(function(a){"text/html"===a.mimetype?(backNode.file=a,$("#resize-iframe").css("background-image","none"),$(backNode.iframe).attr("src",a.url).load(function(){backNode.document=this.contentDocument,backNode.editor.addCkeditor(backNode.document),$("body",$("#iframe").contents()).on("click","#bn-picUpload",function(){backNode.explorer.pick(function(a){var b=backNode.editingPicture;if(~imgAllowed.indexOf(a.mimetype)){var c=backNode.file.url.split("/");c.pop(),c=c.join("/")+"/";var d=absToRel(c,a.url);b.attr("src",d),$("#bn-popinPicture div div span",$("#iframe").contents()).click()}else window.alert("Invalid extension !")})}),$("#dark-bgr").stop().fadeOut(150),$("#tools ul li:not(#open)").show(),$("#edit-mode").slideDown()})):window.alert("Invalid extension !")},!0)});var i=$("#iframe").contents().get(0);$(i).bind("click",function(){backNode.file||$("#open").click()}),$("#tools #cancel").click(function(){var a=$("#iframe")[0];a.src=a.src}),$("#tools #save").click(function(){return null===backNode.file?void window.alert("No file chosen !"):($("#dark-bgr").stop().fadeIn(150),backNode.editor.editable(backNode.baliseSearch.getList(backNode.document),!1),backNode.editor.cleanCkeditor(backNode.document),void backNode.explorer.save(function(){window.alert("File saved !"),$("#dark-bgr").stop().fadeOut(150),$("#tools #editor").toggleClass("switch-on"),backNode.iframe.contentWindow.CKEDITOR=null,backNode.editor.addCkeditor(backNode.document)}))}),$("body").mousedown(function(a){activeResize=$(a.target).is($("#resize-icon"))}).mouseup(function(a){$(a.target).is($("#CE .close-btn"))&&$("#dark-bgr").hide(),activeResize=!1}),$("body").mousemove(function(a){if(activeResize){var b=f.width()-a.pageX+f.offset().left-5,c=f.height()-a.pageY-f.offset().top-5,g=f.width()/2-105,h=f.height()/2-105;b=g>=b?b:g,c=h>=c?c:h,b=b>=10?b:10,c=c>=10?c:10,e.css({left:b,right:b,top:c,bottom:c}),d.height(e.height()-45),$("#iframe-width").text(d.width()),$("#iframe-height").text(d.height()),oldIframeWidth=d.width(),oldIframeHeight=d.height()}}),$("#resolution").click(function(){$("#resolution-presets").stop().slideToggle(200)}),$("#resolution-presets li").click(function(){a($(this).data("width"),$(this).data("height"),!0)}),$("body").click(function(a){$(a.target).is($("#resolution, #resolution span, #resolution i"))||$("#resolution-presets").slideUp(200)}),$("#CE .close-btn").click(function(){$("#dark-bgr").hide()}),$("#CE").on("dragover",".dropzone, .ce-item",function(){var a=$(this);a.addClass("dragover"),clearTimeout(this.dragTimeout),this.dragTimeout=setTimeout(function(){a.removeClass("dragover")},100)}).on("dragleave",".dropzone, .ce-item",function(){$(this).removeClass("dragover")}),$(window).resize(function(){a(oldIframeWidth,oldIframeHeight),oldIframeWidth=d.width(),oldIframeHeight=d.height(),d.height(e.height()-45),e.width()<200&&e.css({left:f.width()/2-105,right:f.width()/2-105}),e.height()<200&&e.css({top:f.height()/2-105,bottom:f.height()/2-105}),$("#iframe-width").text(d.width()),$("#iframe-height").text(d.height()),$("#tools").height($(window).height()),$("#CE").css({marginLeft:-($("#CE").width()/2),marginTop:-($("#CE").height()/2)});var b=$(window).height()-$("#menu-wrapper").height()-110;b>200?$("#tools #background").stop().fadeIn().css({backgroundImage:"url('img/backnode.png')",height:b}):50>b?$("#tools #background").stop().fadeOut(50):$("#tools #background").stop().fadeIn().css({backgroundImage:"url('img/logo.png')",height:86})}).resize()});
//# sourceMappingURL=script.min.map